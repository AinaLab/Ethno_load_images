<!DOCTYPE html>
<html lang="fr">
  <head>
    <script src="https://miro.com/app/static/sdk.1.1.js"></script>
	  
	  
	  <script> 
		  miro.onReady(async() => {
			  		const isAuthorized = await miro.isAuthorized()
					if (!isAuthorized) {
						await miro.requestAuthorization()// Ask the user to authorize the app.
					}
					let widgets = await miro.board.widgets.get();
					stickers = widgets.filter((widget) => widget.y <= -4500);
					for (let n=0; n<stickers.length;n++){
						let sticker = await miro.board.widgets.get({id:stickers[n].id});
						sticker = sticker[0];
						text = sticker.plainText;
						start_url = text.search(" url:");
						start_x = text.search(" _x:");
						url = text.substring(start_url+5,start_x);
						console.log(url)
						console.log(text.substring(start_x+4))
						await miro.board.widgets.create({type:'image',url:url, title:text.substring(6,start_url), scale:0.15,y:-3000, x:text.substring(start_x+4)})
						await miro.board.widgets.deleteById(sticker.id);
					}
		})
	  </script>
	  
	  

  </head>

</html>
